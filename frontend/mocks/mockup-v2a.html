<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Artifacts MMO - Dungeon Command Console</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
  }

  :root {
    --stone-dark: #1a1a1e;
    --stone-mid: #2a2a2e;
    --stone-light: #3a3a3e;
    --iron-dark: #3a3a3a;
    --iron-mid: #5a5a5a;
    --iron-light: #6a6a6a;
    --iron-highlight: #8a8a8a;
    --bone: #d4c8a8;
    --bone-dim: #9a917a;
    --amber: #d4891a;
    --amber-glow: #e8a030;
    --amber-bright: #f0b848;
    --hp-red: #8b1a1a;
    --hp-red-light: #b82a2a;
    --xp-gold: #8a7a20;
    --xp-gold-light: #b8a830;
    --cooldown-blue: #2a4a6a;
    --cooldown-blue-light: #3a6a9a;
    --ready-green: #2a6a2a;
    --ready-green-light: #3a9a3a;
  }

  @keyframes torchFlicker {
    0%   { opacity: 1.0; filter: brightness(1.0); }
    10%  { opacity: 0.92; filter: brightness(0.95); }
    20%  { opacity: 1.0; filter: brightness(1.05); }
    30%  { opacity: 0.88; filter: brightness(0.92); }
    40%  { opacity: 0.96; filter: brightness(1.0); }
    50%  { opacity: 1.0; filter: brightness(1.08); }
    60%  { opacity: 0.90; filter: brightness(0.94); }
    70%  { opacity: 0.98; filter: brightness(1.02); }
    80%  { opacity: 0.86; filter: brightness(0.90); }
    90%  { opacity: 1.0; filter: brightness(1.04); }
    100% { opacity: 1.0; filter: brightness(1.0); }
  }

  @keyframes torchGlow {
    0%   { text-shadow: 0 0 4px #d4891a88, 0 0 8px #d4891a44; }
    25%  { text-shadow: 0 0 6px #e8a030aa, 0 0 12px #d4891a66; }
    50%  { text-shadow: 0 0 4px #d4891a88, 0 0 10px #d4891a55; }
    75%  { text-shadow: 0 0 8px #f0b848bb, 0 0 14px #d4891a77; }
    100% { text-shadow: 0 0 4px #d4891a88, 0 0 8px #d4891a44; }
  }

  @keyframes readyFlash {
    0%   { color: var(--ready-green-light); opacity: 1; }
    50%  { color: #5ada5a; opacity: 0.6; }
    100% { color: var(--ready-green-light); opacity: 1; }
  }

  @keyframes borderGlow {
    0%   { box-shadow: inset 0 0 8px #d4891a11, 0 0 4px #d4891a11; }
    50%  { box-shadow: inset 0 0 12px #d4891a22, 0 0 8px #d4891a18; }
    100% { box-shadow: inset 0 0 8px #d4891a11, 0 0 4px #d4891a11; }
  }

  body {
    font-family: 'Press Start 2P', monospace;
    background-color: var(--stone-dark);
    background-image:
      repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        #1e1e2208 2px,
        #1e1e2208 4px
      ),
      repeating-linear-gradient(
        90deg,
        transparent,
        transparent 2px,
        #22222608 2px,
        #22222608 4px
      ),
      repeating-linear-gradient(
        45deg,
        transparent,
        transparent 8px,
        #18181c06 8px,
        #18181c06 10px
      ),
      repeating-linear-gradient(
        -45deg,
        transparent,
        transparent 12px,
        #20202406 12px,
        #20202406 14px
      ),
      radial-gradient(ellipse at 30% 20%, #2a2a3015 0%, transparent 50%),
      radial-gradient(ellipse at 70% 80%, #2a2a3012 0%, transparent 50%);
    color: var(--bone);
    min-height: 100vh;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* --- HEADER --- */
  .header {
    text-align: center;
    margin-bottom: 24px;
    padding: 16px 32px;
    border: 4px solid var(--iron-dark);
    background:
      linear-gradient(180deg, #2a2a2e 0%, #1a1a1e 100%);
    box-shadow:
      inset 2px 2px 0 var(--iron-light),
      inset -2px -2px 0 #1a1a1a,
      0 4px 0 #0a0a0a,
      /* corner rivets */
      -4px -4px 0 0 var(--iron-mid),
      4px -4px 0 0 var(--iron-mid),
      -4px 4px 0 0 var(--iron-mid),
      4px 4px 0 0 var(--iron-mid);
    position: relative;
  }

  .header h1 {
    font-size: 14px;
    color: var(--amber);
    letter-spacing: 2px;
    animation: torchGlow 3s ease-in-out infinite;
  }

  .header .subtitle {
    font-size: 7px;
    color: var(--bone-dim);
    margin-top: 8px;
    letter-spacing: 1px;
  }

  /* --- RIVET DECORATION --- */
  .rivet {
    position: absolute;
    width: 6px;
    height: 6px;
    background: var(--iron-mid);
    box-shadow:
      inset 1px 1px 0 var(--iron-highlight),
      inset -1px -1px 0 #2a2a2a;
  }
  .rivet-tl { top: 4px; left: 4px; }
  .rivet-tr { top: 4px; right: 4px; }
  .rivet-bl { bottom: 4px; left: 4px; }
  .rivet-br { bottom: 4px; right: 4px; }

  /* --- CARDS CONTAINER --- */
  .cards-container {
    display: flex;
    flex-direction: column;
    gap: 16px;
    width: 100%;
    max-width: 860px;
  }

  /* --- CHARACTER CARD --- */
  .char-card {
    display: grid;
    grid-template-columns: 120px 1fr 1fr;
    grid-template-rows: auto auto;
    border: 4px solid var(--iron-dark);
    background:
      linear-gradient(180deg, #222228 0%, #1c1c20 40%, #1a1a1e 100%);
    position: relative;
    animation: borderGlow 4s ease-in-out infinite;
    box-shadow:
      inset 2px 2px 0 var(--iron-light),
      inset -2px -2px 0 #141418,
      0 4px 0 #0a0a0a,
      0 6px 0 #050508;
  }

  /* --- PORTRAIT SECTION --- */
  .portrait-section {
    grid-row: 1 / 3;
    grid-column: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 12px 8px;
    border-right: 4px solid var(--iron-dark);
    background:
      linear-gradient(180deg, #1e1e22 0%, #16161a 100%);
    position: relative;
  }

  .portrait-frame {
    border: 3px solid var(--iron-dark);
    box-shadow:
      inset 2px 2px 0 var(--iron-light),
      inset -2px -2px 0 #0e0e0e,
      0 0 8px #d4891a18;
    background: #0e0e12;
    padding: 4px;
    position: relative;
    animation: torchFlicker 2.5s ease-in-out infinite;
  }

  .portrait-canvas {
    display: block;
    width: 84px;
    height: 84px;
    image-rendering: pixelated;
  }

  .char-name {
    font-size: 8px;
    color: var(--amber);
    margin-top: 8px;
    text-align: center;
    animation: torchGlow 3.5s ease-in-out infinite;
    letter-spacing: 1px;
  }

  .char-level {
    font-size: 7px;
    color: var(--bone-dim);
    margin-top: 4px;
    text-align: center;
  }

  .char-level span {
    color: var(--amber-bright);
    font-size: 9px;
  }

  /* --- CENTER STATS PANEL --- */
  .stats-panel {
    grid-row: 1;
    grid-column: 2;
    padding: 12px 14px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    border-bottom: 3px solid var(--iron-dark);
    border-right: 3px solid var(--iron-dark);
  }

  /* --- STAT BAR SHARED --- */
  .stat-bar-group {
    display: flex;
    flex-direction: column;
    gap: 3px;
  }

  .stat-bar-label {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 6px;
  }

  .stat-bar-label .label-text {
    color: var(--bone-dim);
    letter-spacing: 1px;
  }

  .stat-bar-label .label-value {
    color: var(--bone);
    font-size: 7px;
  }

  .stat-bar-track {
    height: 10px;
    background: #0e0e12;
    border: 2px solid var(--iron-dark);
    box-shadow: inset 1px 1px 0 #060608;
    position: relative;
    overflow: hidden;
  }

  .stat-bar-fill {
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    transition: width 0.3s ease;
  }

  .stat-bar-fill.hp {
    background: linear-gradient(180deg, var(--hp-red-light) 0%, var(--hp-red) 100%);
    box-shadow: inset 0 -1px 0 #5a1010, inset 0 1px 0 #d83a3a44;
  }

  .stat-bar-fill.xp {
    background: linear-gradient(180deg, var(--xp-gold-light) 0%, var(--xp-gold) 100%);
    box-shadow: inset 0 -1px 0 #5a5010, inset 0 1px 0 #d8c83044;
  }

  /* --- COOLDOWN SECTION --- */
  .cooldown-section {
    grid-row: 2;
    grid-column: 2;
    padding: 10px 14px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    border-right: 3px solid var(--iron-dark);
  }

  .cooldown-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .cooldown-label {
    font-size: 6px;
    color: var(--bone-dim);
    letter-spacing: 1px;
  }

  .cooldown-value {
    font-size: 9px;
    color: var(--cooldown-blue-light);
    letter-spacing: 1px;
    min-width: 60px;
    text-align: right;
  }

  .cooldown-value.ready {
    color: var(--ready-green-light);
    animation: readyFlash 0.4s ease-in-out infinite;
  }

  .cooldown-bar-track {
    height: 8px;
    background: #0e0e12;
    border: 2px solid var(--iron-dark);
    box-shadow: inset 1px 1px 0 #060608;
    position: relative;
    overflow: hidden;
  }

  .cooldown-bar-fill {
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background: linear-gradient(180deg, var(--cooldown-blue-light) 0%, var(--cooldown-blue) 100%);
    box-shadow: inset 0 -1px 0 #1a2a3a, inset 0 1px 0 #4a8aba44;
    transition: width 0.1s linear;
  }

  .cooldown-bar-fill.ready {
    background: linear-gradient(180deg, var(--ready-green-light) 0%, var(--ready-green) 100%);
    box-shadow: inset 0 -1px 0 #1a3a1a, inset 0 1px 0 #4aba4a44;
  }

  /* --- RIGHT INFO PANELS --- */
  .info-panels {
    grid-row: 1 / 3;
    grid-column: 3;
    display: flex;
    flex-direction: column;
  }

  .log-panel, .task-panel {
    padding: 10px 12px;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .log-panel {
    flex: 1;
    border-bottom: 3px solid var(--iron-dark);
  }

  .task-panel {
    flex: 1;
  }

  .panel-label {
    font-size: 6px;
    color: var(--iron-highlight);
    letter-spacing: 1px;
    margin-bottom: 2px;
  }

  .log-text {
    font-size: 7px;
    color: var(--amber-glow);
    line-height: 1.6;
    animation: torchFlicker 3s ease-in-out infinite;
    min-height: 24px;
    display: flex;
    align-items: center;
    word-break: break-word;
  }

  .task-text {
    font-size: 7px;
    color: var(--bone);
    line-height: 1.6;
    min-height: 24px;
    display: flex;
    align-items: center;
    word-break: break-word;
  }

  /* --- BUTTON TOOLBAR --- */
  .button-toolbar {
    grid-column: 1 / 4;
    display: flex;
    border-top: 4px solid var(--iron-dark);
    background: linear-gradient(180deg, #222228 0%, #1a1a1e 100%);
  }

  .toolbar-btn {
    flex: 1;
    padding: 8px 4px;
    font-family: 'Press Start 2P', monospace;
    font-size: 6px;
    color: var(--bone-dim);
    background:
      linear-gradient(180deg, #3a3a3e 0%, #2a2a2e 40%, #222228 100%);
    border: none;
    border-right: 2px solid var(--iron-dark);
    cursor: pointer;
    text-align: center;
    letter-spacing: 1px;
    position: relative;
    box-shadow:
      inset 1px 1px 0 var(--iron-light),
      inset -1px -1px 0 #1a1a1a;
    transition: none;
  }

  .toolbar-btn:last-child {
    border-right: none;
  }

  .toolbar-btn:hover {
    background:
      linear-gradient(180deg, #4a4a4e 0%, #3a3a3e 40%, #2a2a2e 100%);
    color: var(--amber);
    box-shadow:
      inset 1px 1px 0 var(--iron-highlight),
      inset -1px -1px 0 #1a1a1a,
      0 0 6px #d4891a22;
  }

  .toolbar-btn:active {
    background:
      linear-gradient(180deg, #222228 0%, #2a2a2e 40%, #3a3a3e 100%);
    color: var(--amber-bright);
    box-shadow:
      inset -1px -1px 0 var(--iron-light),
      inset 1px 1px 0 #1a1a1a;
  }

  /* --- FOOTER --- */
  .footer {
    margin-top: 20px;
    font-size: 6px;
    color: var(--iron-mid);
    text-align: center;
    letter-spacing: 1px;
  }

  /* --- TORCH DECORATIONS --- */
  .torch-container {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 20px;
  }

  .torch {
    width: 8px;
    height: 20px;
    background: linear-gradient(180deg, #5a3a1a 0%, #3a2a10 100%);
    border: 1px solid #2a1a08;
    position: relative;
  }

  .torch-flame {
    position: absolute;
    top: -12px;
    left: -3px;
    width: 14px;
    height: 14px;
    background: radial-gradient(ellipse at center bottom, #f0b848 0%, #d4891a 40%, #8a3a0a 70%, transparent 100%);
    animation: torchFlicker 1.5s ease-in-out infinite;
    clip-path: polygon(50% 0%, 20% 40%, 0% 100%, 100% 100%, 80% 40%);
  }

  .torch-glow {
    position: absolute;
    top: -20px;
    left: -16px;
    width: 40px;
    height: 30px;
    background: radial-gradient(ellipse at center, #d4891a18 0%, transparent 70%);
    animation: torchFlicker 2s ease-in-out infinite;
    pointer-events: none;
  }

  /* --- STATUS INDICATOR DOT --- */
  .status-dot {
    width: 6px;
    height: 6px;
    background: var(--ready-green-light);
    box-shadow: 0 0 4px var(--ready-green-light);
    display: inline-block;
    margin-right: 4px;
    animation: torchFlicker 2s ease-in-out infinite;
  }

  .status-line {
    font-size: 6px;
    color: var(--bone-dim);
    display: flex;
    align-items: center;
    margin-bottom: 4px;
  }
</style>
</head>
<body>

<div class="header">
  <div class="rivet rivet-tl"></div>
  <div class="rivet rivet-tr"></div>
  <div class="rivet rivet-bl"></div>
  <div class="rivet rivet-br"></div>
  <h1>ARTIFACTS MMO</h1>
  <div class="subtitle">DUNGEON COMMAND CONSOLE</div>
</div>

<div class="torch-container">
  <div class="torch">
    <div class="torch-flame"></div>
    <div class="torch-glow"></div>
  </div>
  <div class="status-line">
    <div class="status-dot"></div>
    3 CHARACTERS ACTIVE
  </div>
  <div class="torch">
    <div class="torch-flame" style="animation-delay: -0.7s;"></div>
    <div class="torch-glow" style="animation-delay: -0.7s;"></div>
  </div>
</div>

<div class="cards-container" id="cards-container"></div>

<div class="footer">
  ARTIFACTS MMO BOT MANAGER v2.0 &mdash; STONE & IRON EDITION
</div>

<script>
  // --- MOCK DATA ---
  const characters = [
    {
      name: 'Artifax',
      level: 25,
      hp: 340,
      maxHp: 450,
      xp: 12500,
      maxXp: 18000,
      portraitType: 'warrior',
      cooldown: 12.0,
      maxCooldown: 15.0,
      log: 'Fighting Chicken (Lv.3)...',
      task: 'Kill 50 Chickens (32/50)',
      logs: [
        'Fighting Chicken (Lv.3)...',
        'Looted: Feather x2, Raw Chicken x1',
        'Moving to Chicken Coop [2,-1]...',
        'Equipping Iron Sword (+12 ATK)...'
      ],
      tasks: [
        'Kill 50 Chickens (32/50)',
        'Kill 50 Chickens (34/50)',
        'Kill 50 Chickens (36/50)',
        'Kill 50 Chickens (38/50)'
      ]
    },
    {
      name: 'Luminos',
      level: 18,
      hp: 180,
      maxHp: 220,
      xp: 8200,
      maxXp: 12000,
      portraitType: 'mage',
      cooldown: 8.0,
      maxCooldown: 12.0,
      log: 'Crafting Iron Sword...',
      task: 'Craft 10 Iron Swords (7/10)',
      logs: [
        'Crafting Iron Sword...',
        'Withdrawing 6 Iron Ore from bank...',
        'Smelting Iron Ingot at Forge...',
        'Depositing Iron Sword to bank...'
      ],
      tasks: [
        'Craft 10 Iron Swords (7/10)',
        'Craft 10 Iron Swords (8/10)',
        'Craft 10 Iron Swords (8/10)',
        'Craft 10 Iron Swords (9/10)'
      ]
    },
    {
      name: 'Verdant',
      level: 22,
      hp: 260,
      maxHp: 300,
      xp: 15600,
      maxXp: 20000,
      portraitType: 'gatherer',
      cooldown: 3.0,
      maxCooldown: 8.0,
      log: 'Gathering Ash Wood...',
      task: 'Gather 100 Ash Wood (89/100)',
      logs: [
        'Gathering Ash Wood...',
        'Gathered: Ash Wood x3',
        'Inventory: 87/100 slots used',
        'Moving to Ash Forest [1,6]...'
      ],
      tasks: [
        'Gather 100 Ash Wood (89/100)',
        'Gather 100 Ash Wood (92/100)',
        'Gather 100 Ash Wood (95/100)',
        'Gather 100 Ash Wood (98/100)'
      ]
    }
  ];

  // --- PORTRAIT PIXEL ART PALETTES ---
  const palettes = {
    warrior: {
      helmet:    '#7a7a8a',
      helmetDk:  '#4a4a5a',
      helmetLt:  '#9a9aaa',
      visor:     '#2a2a3a',
      skin:      '#c8a882',
      skinDk:    '#a08060',
      eyes:      '#1a1a2a',
      armor:     '#5a5a6a',
      armorDk:   '#3a3a4a',
      armorLt:   '#7a7a8a',
      accent:    '#8a6a3a'
    },
    mage: {
      hat:       '#3a2a6a',
      hatDk:     '#2a1a4a',
      hatLt:     '#5a3a9a',
      hatStar:   '#e8d848',
      skin:      '#d8b898',
      skinDk:    '#b89878',
      eyes:      '#2a1a4a',
      robe:      '#4a3a7a',
      robeDk:    '#3a2a5a',
      robeLt:    '#6a5a9a',
      accent:    '#e8d848'
    },
    gatherer: {
      hood:      '#2a5a2a',
      hoodDk:    '#1a3a1a',
      hoodLt:    '#3a7a3a',
      skin:      '#c8a878',
      skinDk:    '#a88858',
      eyes:      '#1a2a1a',
      tunic:     '#3a6a3a',
      tunicDk:   '#2a4a2a',
      tunicLt:   '#4a8a4a',
      accent:    '#8a7a3a'
    }
  };

  // --- PIXEL ART DRAWING ---
  function drawPortrait(canvas, type) {
    const ctx = canvas.getContext('2d');
    const p = palettes[type];
    // Canvas is 12x14, will be scaled via CSS
    canvas.width = 12;
    canvas.height = 14;

    const px = (x, y, color) => {
      ctx.fillStyle = color;
      ctx.fillRect(x, y, 1, 1);
    };

    const rect = (x, y, w, h, color) => {
      ctx.fillStyle = color;
      ctx.fillRect(x, y, w, h);
    };

    // Background
    rect(0, 0, 12, 14, '#0e0e12');

    if (type === 'warrior') {
      // Helmet top
      rect(3, 0, 6, 1, p.helmetDk);
      rect(2, 1, 8, 1, p.helmet);
      rect(2, 2, 8, 1, p.helmet);
      px(2, 1, p.helmetDk); px(9, 1, p.helmetDk);
      // Helmet crest
      px(5, 0, p.helmetLt); px(6, 0, p.helmetLt);
      // Helmet brim
      rect(1, 3, 10, 1, p.helmetDk);
      // Visor slit
      rect(3, 3, 6, 1, p.visor);
      // Face
      rect(3, 4, 6, 3, p.skin);
      px(3, 4, p.skinDk); px(8, 4, p.skinDk);
      // Eyes
      px(4, 5, p.eyes); px(7, 5, p.eyes);
      // Mouth
      px(5, 6, p.skinDk); px(6, 6, p.skinDk);
      // Nose
      px(5, 5, p.skinDk);
      // Neck
      rect(4, 7, 4, 1, p.skin);
      // Armor body
      rect(2, 8, 8, 4, p.armor);
      rect(3, 8, 6, 1, p.armorLt);
      px(2, 8, p.armorDk); px(9, 8, p.armorDk);
      px(2, 11, p.armorDk); px(9, 11, p.armorDk);
      // Armor detail
      px(5, 9, p.accent); px(6, 9, p.accent);
      px(5, 10, p.accent); px(6, 10, p.accent);
      // Shoulders
      rect(1, 8, 1, 3, p.armorDk);
      rect(10, 8, 1, 3, p.armorDk);
      // Belt
      rect(2, 12, 8, 1, p.accent);
      // Legs
      rect(3, 13, 2, 1, p.armorDk);
      rect(7, 13, 2, 1, p.armorDk);
    }

    else if (type === 'mage') {
      // Hat tip
      px(5, 0, p.hatDk); px(6, 0, p.hatDk);
      px(6, 0, p.hat);
      // Hat cone
      rect(4, 1, 3, 1, p.hat);
      rect(3, 2, 5, 1, p.hat);
      rect(3, 3, 6, 1, p.hat);
      px(4, 1, p.hatLt);
      // Star on hat
      px(5, 2, p.hatStar);
      // Hat brim
      rect(1, 4, 10, 1, p.hatDk);
      px(1, 4, p.hat); px(10, 4, p.hat);
      // Face
      rect(3, 5, 6, 3, p.skin);
      px(3, 5, p.skinDk); px(8, 5, p.skinDk);
      // Eyes (mystical)
      px(4, 6, p.eyes); px(7, 6, p.eyes);
      px(4, 5, p.accent); px(7, 5, p.accent); // glow above eyes
      // Mouth
      px(5, 7, p.skinDk); px(6, 7, p.skinDk);
      // Beard hint
      px(4, 7, p.skinDk); px(7, 7, p.skinDk);
      // Neck
      rect(4, 8, 4, 1, p.skin);
      // Robe body
      rect(2, 9, 8, 4, p.robe);
      rect(3, 9, 6, 1, p.robeLt);
      px(2, 9, p.robeDk); px(9, 9, p.robeDk);
      px(2, 12, p.robeDk); px(9, 12, p.robeDk);
      // Robe accent stripe
      px(5, 10, p.accent); px(6, 10, p.accent);
      px(5, 11, p.accent); px(6, 11, p.accent);
      px(5, 12, p.accent); px(6, 12, p.accent);
      // Sleeves
      rect(1, 9, 1, 3, p.robeDk);
      rect(10, 9, 1, 3, p.robeDk);
      // Robe bottom
      rect(2, 13, 8, 1, p.robeDk);
    }

    else if (type === 'gatherer') {
      // Hood top
      rect(3, 0, 6, 1, p.hoodDk);
      rect(2, 1, 8, 1, p.hood);
      rect(2, 2, 8, 1, p.hood);
      px(2, 1, p.hoodDk); px(9, 1, p.hoodDk);
      px(3, 0, p.hoodLt); px(4, 0, p.hoodLt);
      // Hood sides
      rect(2, 3, 1, 2, p.hood);
      rect(9, 3, 1, 2, p.hood);
      rect(1, 2, 1, 3, p.hoodDk);
      rect(10, 2, 1, 3, p.hoodDk);
      // Face
      rect(3, 3, 6, 3, p.skin);
      px(3, 3, p.skinDk); px(8, 3, p.skinDk);
      // Eyes
      px(4, 4, p.eyes); px(7, 4, p.eyes);
      // Nose
      px(5, 4, p.skinDk);
      // Friendly mouth
      px(5, 5, p.skinDk); px(6, 5, p.skinDk);
      // Neck
      rect(4, 6, 4, 1, p.skin);
      // Tunic body
      rect(2, 7, 8, 5, p.tunic);
      rect(3, 7, 6, 1, p.tunicLt);
      px(2, 7, p.tunicDk); px(9, 7, p.tunicDk);
      px(2, 11, p.tunicDk); px(9, 11, p.tunicDk);
      // Belt
      rect(2, 10, 8, 1, p.accent);
      // Belt buckle
      px(5, 10, '#c8a848'); px(6, 10, '#c8a848');
      // Tunic details
      px(4, 8, p.tunicDk); px(7, 8, p.tunicDk);
      // Sleeves
      rect(1, 7, 1, 3, p.tunicDk);
      rect(10, 7, 1, 3, p.tunicDk);
      // Legs
      rect(3, 12, 2, 2, p.hoodDk);
      rect(7, 12, 2, 2, p.hoodDk);
    }
  }

  // --- STATE ---
  const state = characters.map((c, i) => ({
    cooldown: c.cooldown,
    maxCooldown: c.maxCooldown,
    isReady: false,
    readyTimer: 0,
    logIndex: 0,
    taskIndex: 0,
    logTimer: 0,
    taskTimer: 0
  }));

  // --- RENDER CARDS ---
  function renderCards() {
    const container = document.getElementById('cards-container');
    container.innerHTML = '';

    characters.forEach((char, i) => {
      const card = document.createElement('div');
      card.className = 'char-card';
      card.innerHTML = `
        <div class="rivet rivet-tl"></div>
        <div class="rivet rivet-tr"></div>
        <div class="rivet rivet-bl"></div>
        <div class="rivet rivet-br"></div>

        <div class="portrait-section">
          <div class="portrait-frame">
            <canvas class="portrait-canvas" id="portrait-${i}"></canvas>
          </div>
          <div class="char-name">${char.name}</div>
          <div class="char-level">LVL <span>${char.level}</span></div>
        </div>

        <div class="stats-panel">
          <div class="stat-bar-group">
            <div class="stat-bar-label">
              <span class="label-text">HP</span>
              <span class="label-value" id="hp-val-${i}">${char.hp}/${char.maxHp}</span>
            </div>
            <div class="stat-bar-track">
              <div class="stat-bar-fill hp" id="hp-bar-${i}" style="width: ${(char.hp / char.maxHp) * 100}%"></div>
            </div>
          </div>
          <div class="stat-bar-group">
            <div class="stat-bar-label">
              <span class="label-text">XP</span>
              <span class="label-value" id="xp-val-${i}">${char.xp.toLocaleString()}/${char.maxXp.toLocaleString()}</span>
            </div>
            <div class="stat-bar-track">
              <div class="stat-bar-fill xp" id="xp-bar-${i}" style="width: ${(char.xp / char.maxXp) * 100}%"></div>
            </div>
          </div>
        </div>

        <div class="info-panels">
          <div class="log-panel">
            <div class="panel-label">LATEST LOG</div>
            <div class="log-text" id="log-${i}">${char.log}</div>
          </div>
          <div class="task-panel">
            <div class="panel-label">CURRENT TASK</div>
            <div class="task-text" id="task-${i}">${char.task}</div>
          </div>
        </div>

        <div class="cooldown-section">
          <div class="cooldown-header">
            <span class="cooldown-label">COOLDOWN</span>
            <span class="cooldown-value" id="cd-val-${i}">${char.cooldown.toFixed(1)}s</span>
          </div>
          <div class="cooldown-bar-track">
            <div class="cooldown-bar-fill" id="cd-bar-${i}" style="width: ${(char.cooldown / char.maxCooldown) * 100}%"></div>
          </div>
        </div>

        <div class="button-toolbar">
          <button class="toolbar-btn">EQUIP</button>
          <button class="toolbar-btn">INVEN</button>
          <button class="toolbar-btn">SKILLS</button>
          <button class="toolbar-btn">STATS</button>
          <button class="toolbar-btn">ACHIEV</button>
        </div>
      `;
      container.appendChild(card);

      // Draw portrait
      const canvas = document.getElementById(`portrait-${i}`);
      drawPortrait(canvas, char.portraitType);
    });
  }

  // --- TICK LOOP (100ms) ---
  const TICK = 100;
  const LOG_INTERVAL = 3000;
  const TASK_INTERVAL = 4500;
  const READY_DISPLAY_MS = 1500;

  function tick() {
    characters.forEach((char, i) => {
      const s = state[i];

      // Cooldown countdown
      if (!s.isReady) {
        s.cooldown -= TICK / 1000;
        if (s.cooldown <= 0) {
          s.cooldown = 0;
          s.isReady = true;
          s.readyTimer = 0;
        }
      } else {
        s.readyTimer += TICK;
        if (s.readyTimer >= READY_DISPLAY_MS) {
          // Reset cooldown
          s.isReady = false;
          s.cooldown = s.maxCooldown;
          s.readyTimer = 0;
        }
      }

      // Update cooldown display
      const cdVal = document.getElementById(`cd-val-${i}`);
      const cdBar = document.getElementById(`cd-bar-${i}`);

      if (s.isReady) {
        cdVal.textContent = 'READY';
        cdVal.className = 'cooldown-value ready';
        cdBar.className = 'cooldown-bar-fill ready';
        cdBar.style.width = '100%';
      } else {
        cdVal.textContent = s.cooldown.toFixed(1) + 's';
        cdVal.className = 'cooldown-value';
        cdBar.className = 'cooldown-bar-fill';
        cdBar.style.width = (s.cooldown / s.maxCooldown * 100) + '%';
      }

      // Log cycling
      s.logTimer += TICK;
      if (s.logTimer >= LOG_INTERVAL) {
        s.logTimer = 0;
        s.logIndex = (s.logIndex + 1) % char.logs.length;
        const logEl = document.getElementById(`log-${i}`);
        logEl.textContent = char.logs[s.logIndex];
      }

      // Task cycling
      s.taskTimer += TICK;
      if (s.taskTimer >= TASK_INTERVAL) {
        s.taskTimer = 0;
        s.taskIndex = (s.taskIndex + 1) % char.tasks.length;
        const taskEl = document.getElementById(`task-${i}`);
        taskEl.textContent = char.tasks[s.taskIndex];
      }
    });
  }

  // --- INIT ---
  renderCards();
  setInterval(tick, TICK);
</script>

</body>
</html>
