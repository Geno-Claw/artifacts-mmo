<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Artifacts MMO Bot Manager — Sakura Garden (Compact Party Strips)</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
/* ============================================================
   SAKURA GARDEN — Compact Party Strips
   ============================================================ */
*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  image-rendering: pixelated;
  -ms-interpolation-mode: nearest-neighbor;
}

:root {
  --pale-pink: #f0d0d8;
  --lavender: #d0c0e8;
  --cream: #f8f0e8;
  --dark-plum: #3a1828;
  --border-dark: #4a2838;
  --rose-red: #d06878;
  --rose-red-bg: #f0c8d0;
  --wisteria: #9878b8;
  --wisteria-bg: #e0d0f0;
  --wood-light: #e8d0a8;
  --wood-mid: #d0b888;
  --wood-dark: #a08058;
  --wood-shadow: #786040;
  --petal-pink: #f0a0b8;
  --petal-light: #f8c8d8;
  --branch-dark: #684848;
  --branch-mid: #886060;
  --branch-light: #a08070;
  --leaf-green: #88b878;
  --card-bg: #faf4ee;
  --card-inset: #f0e8e0;
  --inset-border: #d8c8b8;
  --text-muted: #785868;
  --ready-glow: #c8f0a0;
}

html {
  font-family: 'Press Start 2P', monospace;
  font-size: 8px;
  color: var(--dark-plum);
  background: var(--cream);
}

body {
  min-height: 100vh;
  background:
    linear-gradient(180deg, var(--lavender) 0%, var(--cream) 40%, var(--pale-pink) 100%);
  overflow-x: hidden;
  position: relative;
}

/* Subtle pixel dot pattern overlay */
body::before {
  content: '';
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background-image:
    radial-gradient(circle, var(--border-dark) 0.5px, transparent 0.5px);
  background-size: 16px 16px;
  opacity: 0.025;
  pointer-events: none;
  z-index: 0;
}

/* ============================================================
   PETAL ANIMATION — floating cherry blossom squares
   ============================================================ */
.petals-container {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  pointer-events: none;
  z-index: 1;
  overflow: hidden;
}

.petal {
  position: absolute;
  width: 4px;
  height: 4px;
  opacity: 0;
  animation: petalFall linear infinite;
}

@keyframes petalFall {
  0% {
    opacity: 0;
    transform: translateY(-10px) translateX(0px) rotate(0deg);
  }
  5% {
    opacity: 0.7;
  }
  50% {
    opacity: 0.5;
  }
  95% {
    opacity: 0.3;
  }
  100% {
    opacity: 0;
    transform: translateY(100vh) translateX(80px) rotate(720deg);
  }
}

/* ============================================================
   HEADER — compact
   ============================================================ */
.page-header {
  position: relative;
  z-index: 2;
  text-align: center;
  padding: 24px 16px 4px;
}

.page-header h1 {
  font-size: 12px;
  letter-spacing: 2px;
  color: var(--dark-plum);
  text-shadow: 2px 2px 0 var(--pale-pink);
  margin-bottom: 4px;
}

.page-header .subtitle {
  font-size: 6px;
  color: var(--text-muted);
  letter-spacing: 4px;
  text-transform: uppercase;
}

/* Decorative divider */
.divider {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin: 10px auto;
  max-width: 400px;
}

.divider-line {
  flex: 1;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--border-dark), transparent);
}

.divider-diamond {
  width: 5px;
  height: 5px;
  background: var(--petal-pink);
  transform: rotate(45deg);
  border: 1px solid var(--border-dark);
}

/* ============================================================
   STRIPS CONTAINER
   ============================================================ */
.strips-container {
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  padding: 6px 16px 32px;
}

/* ============================================================
   SHARED CHERRY BRANCH BANNER — one long branch across top
   ============================================================ */
.cherry-banner {
  position: relative;
  width: 100%;
  max-width: 720px;
  height: 32px;
  overflow: hidden;
  margin-bottom: 2px;
}

.cherry-banner canvas {
  display: block;
  width: 100%;
  height: 32px;
  image-rendering: pixelated;
}

/* ============================================================
   CHARACTER STRIP — compact horizontal bar
   ============================================================ */
.strip {
  width: 100%;
  max-width: 720px;
  height: 120px;
  background: var(--card-bg);
  border: 1px solid var(--border-dark);
  position: relative;
  display: flex;
  align-items: center;
  gap: 0;
  box-shadow:
    2px 2px 0 0 rgba(74, 40, 56, 0.1),
    inset 0 0 0 1px rgba(255, 255, 255, 0.4);
  overflow: hidden;
}

/* Inner shoji frame line */
.strip::before {
  content: '';
  position: absolute;
  top: 2px; left: 2px; right: 2px; bottom: 2px;
  border: 1px solid rgba(74, 40, 56, 0.08);
  pointer-events: none;
  z-index: 1;
}

/* Decorative cherry blossom clusters on LEFT edge */
.strip::after {
  content: '';
  position: absolute;
  top: 0; left: 0;
  width: 4px;
  height: 100%;
  background: linear-gradient(
    180deg,
    transparent 10%,
    var(--petal-light) 20%,
    var(--petal-pink) 30%,
    transparent 40%,
    transparent 55%,
    var(--petal-light) 65%,
    var(--petal-pink) 72%,
    transparent 82%
  );
  opacity: 0.6;
  pointer-events: none;
  z-index: 2;
}

/* Right edge blossom cluster via extra element */
.strip-right-blossoms {
  position: absolute;
  top: 0; right: 0;
  width: 4px;
  height: 100%;
  background: linear-gradient(
    180deg,
    transparent 15%,
    var(--petal-pink) 25%,
    var(--petal-light) 35%,
    transparent 45%,
    transparent 60%,
    var(--petal-pink) 68%,
    var(--petal-light) 76%,
    transparent 86%
  );
  opacity: 0.6;
  pointer-events: none;
  z-index: 2;
}

/* ============================================================
   STRIP SECTIONS
   ============================================================ */

/* Section: Portrait */
.strip-portrait {
  flex-shrink: 0;
  width: 80px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 8px 0 10px;
  position: relative;
  z-index: 3;
}

.strip-portrait-border {
  border: 1px solid var(--border-dark);
  box-shadow:
    inset 0 0 0 1px rgba(255, 255, 255, 0.3),
    1px 1px 0 0 rgba(74, 40, 56, 0.08);
  background: var(--card-inset);
  padding: 2px;
  line-height: 0;
}

.strip-portrait-border canvas {
  display: block;
  width: 64px;
  height: 64px;
  image-rendering: pixelated;
}

/* Section: Name + Level */
.strip-identity {
  flex-shrink: 0;
  width: 100px;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: center;
  gap: 6px;
  padding: 0 8px;
  position: relative;
  z-index: 3;
}

.strip-name {
  font-size: 9px;
  letter-spacing: 1px;
  color: var(--dark-plum);
  text-shadow: 1px 1px 0 rgba(240, 208, 216, 0.5);
  white-space: nowrap;
}

.strip-level {
  display: inline-block;
  font-size: 6px;
  color: var(--dark-plum);
  background: var(--wood-light);
  border: 1px solid var(--border-dark);
  padding: 2px 6px;
  letter-spacing: 1px;
  box-shadow: 1px 1px 0 rgba(74, 40, 56, 0.08);
}

/* Section: HP/XP bars */
.strip-bars {
  flex-shrink: 0;
  width: 140px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 4px;
  padding: 0 8px;
  position: relative;
  z-index: 3;
}

.strip-stat-row {
  display: flex;
  align-items: center;
  gap: 4px;
}

.strip-stat-label {
  font-size: 5px;
  width: 14px;
  text-align: right;
  color: var(--text-muted);
  flex-shrink: 0;
}

.strip-bar-track {
  flex: 1;
  height: 6px;
  background: var(--rose-red-bg);
  border: 1px solid var(--border-dark);
  position: relative;
  overflow: hidden;
}

.strip-bar-track.xp-track {
  background: var(--wisteria-bg);
}

.strip-bar-fill {
  height: 100%;
  background: var(--rose-red);
  transition: width 0.3s ease;
  position: relative;
}

.strip-bar-fill::after {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: rgba(255, 255, 255, 0.35);
}

.strip-bar-fill.xp-fill {
  background: var(--wisteria);
}

.strip-stat-value {
  font-size: 5px;
  width: 50px;
  text-align: left;
  color: var(--text-muted);
  flex-shrink: 0;
  white-space: nowrap;
}

/* Section: Cooldown */
.strip-cooldown {
  flex-shrink: 0;
  width: 68px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 3px;
  padding: 0 6px;
  position: relative;
  z-index: 3;
}

.strip-cd-bar-track {
  width: 100%;
  height: 6px;
  background: var(--card-inset);
  border: 1px solid var(--border-dark);
  position: relative;
  overflow: hidden;
}

.strip-cd-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--wood-light), var(--wood-mid));
  transition: width 0.1s linear;
  position: relative;
}

.strip-cd-bar-fill::after {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 2px;
  background: rgba(255, 255, 255, 0.3);
}

.strip-cd-bar-fill.ready {
  background: var(--ready-glow);
}

.strip-cd-text {
  font-size: 7px;
  color: var(--dark-plum);
  letter-spacing: 0.5px;
  white-space: nowrap;
}

.strip-cd-text.ready-flash {
  color: var(--leaf-green);
  animation: readyPulse 0.3s ease-in-out infinite alternate;
}

@keyframes readyPulse {
  0% { opacity: 1; }
  100% { opacity: 0.4; }
}

/* Section: Log + Task merged info */
.strip-info {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 4px;
  padding: 0 6px;
  position: relative;
  z-index: 3;
}

.strip-info-line {
  display: flex;
  align-items: center;
  gap: 4px;
  min-width: 0;
}

.strip-info-icon {
  font-size: 5px;
  color: var(--text-muted);
  flex-shrink: 0;
  width: 8px;
  text-align: center;
}

.strip-info-text {
  font-size: 6px;
  line-height: 1.4;
  color: var(--dark-plum);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0;
}

/* Section: Action buttons — small square icons */
.strip-buttons {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  gap: 3px;
  padding: 0 10px 0 4px;
  position: relative;
  z-index: 3;
}

.strip-btn {
  font-family: 'Press Start 2P', monospace;
  font-size: 5px;
  color: var(--dark-plum);
  background: linear-gradient(180deg, var(--wood-light) 0%, var(--wood-mid) 100%);
  border: 1px solid var(--border-dark);
  width: 26px;
  height: 26px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow:
    1px 1px 0 rgba(74, 40, 56, 0.12),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  transition: none;
  line-height: 1;
  padding: 0;
}

.strip-btn:hover {
  background: linear-gradient(180deg, #f0dbb8 0%, #d8c090 100%);
}

.strip-btn:active {
  background: var(--wood-dark);
  color: var(--cream);
  box-shadow:
    inset 1px 1px 0 rgba(0, 0, 0, 0.2);
}

/* ============================================================
   FOOTER
   ============================================================ */
.page-footer {
  position: relative;
  z-index: 2;
  text-align: center;
  padding: 4px 16px 20px;
}

.page-footer p {
  font-size: 5px;
  color: var(--text-muted);
  letter-spacing: 2px;
}

/* ============================================================
   RESPONSIVE
   ============================================================ */
@media (max-width: 760px) {
  .strip {
    height: auto;
    flex-wrap: wrap;
    padding: 8px;
  }

  .strip-portrait {
    width: 70px;
    padding: 0 4px;
  }

  .strip-identity {
    width: 80px;
    padding: 0 4px;
  }

  .strip-bars {
    width: 120px;
    padding: 0 4px;
  }

  .strip-info {
    flex-basis: 100%;
    padding: 4px;
  }

  .strip-buttons {
    flex-basis: 100%;
    justify-content: center;
    padding: 4px;
  }
}
</style>
</head>
<body>

<!-- Floating petals container -->
<div class="petals-container" id="petalsContainer"></div>

<!-- Header -->
<header class="page-header">
  <h1>ARTIFACTS MMO</h1>
  <p class="subtitle">Bot Manager</p>
  <div class="divider">
    <span class="divider-line"></span>
    <span class="divider-diamond"></span>
    <span class="divider-line"></span>
  </div>
</header>

<!-- Strips -->
<main class="strips-container" id="stripsContainer">
  <!-- Shared cherry branch banner rendered here -->
  <div class="cherry-banner">
    <canvas id="bannerCanvas"></canvas>
  </div>
</main>

<!-- Footer -->
<footer class="page-footer">
  <div class="divider" style="margin-bottom: 8px;">
    <span class="divider-line"></span>
    <span class="divider-diamond"></span>
    <span class="divider-line"></span>
  </div>
  <p>SAKURA GARDEN v3.0 — COMPACT</p>
</footer>

<script>
/* ==============================================================
   MOCK DATA
   ============================================================== */
const characters = [
  {
    name: 'Artifax',
    level: 25,
    hp: 340,
    maxHp: 450,
    xp: 12500,
    maxXp: 18000,
    portraitType: 'warrior',
    cooldown: 12.0,
    maxCooldown: 15.0,
    log: 'Fighting Chicken (Lv.3)...',
    task: 'Kill 50 Chickens (32/50)',
    logs: [
      'Fighting Chicken (Lv.3)...',
      'Defeated Chicken! +15 XP',
      'Looted Feather x2',
      'Moving to Hen House...'
    ]
  },
  {
    name: 'Luminos',
    level: 18,
    hp: 180,
    maxHp: 220,
    xp: 8200,
    maxXp: 12000,
    portraitType: 'mage',
    cooldown: 8.0,
    maxCooldown: 12.0,
    log: 'Crafting Iron Sword...',
    task: 'Craft 10 Iron Swords (7/10)',
    logs: [
      'Crafting Iron Sword...',
      'Iron Sword crafted! +80 XP',
      'Withdrawing Iron Ore x5...',
      'Moving to Forge...'
    ]
  },
  {
    name: 'Verdant',
    level: 22,
    hp: 260,
    maxHp: 300,
    xp: 15600,
    maxXp: 20000,
    portraitType: 'gatherer',
    cooldown: 3.0,
    maxCooldown: 8.0,
    log: 'Gathering Ash Wood...',
    task: 'Gather 100 Ash Wood (89/100)',
    logs: [
      'Gathering Ash Wood...',
      'Gathered Ash Wood x3!',
      'Inventory: 89/100 Ash Wood',
      'Moving to Ash Forest...'
    ]
  }
];

/* ==============================================================
   PORTRAIT PIXEL ART DEFINITIONS
   16x16 grid, drawn at native res then displayed via CSS
   ============================================================== */
const PORTRAITS = {
  warrior: {
    pixels: [
      { x: 5, y: 0, c: '#607890' }, { x: 6, y: 0, c: '#607890' }, { x: 7, y: 0, c: '#607890' }, { x: 8, y: 0, c: '#607890' }, { x: 9, y: 0, c: '#607890' },
      { x: 4, y: 1, c: '#607890' }, { x: 5, y: 1, c: '#789cb8' }, { x: 6, y: 1, c: '#789cb8' }, { x: 7, y: 1, c: '#90b8d0' }, { x: 8, y: 1, c: '#789cb8' }, { x: 9, y: 1, c: '#789cb8' }, { x: 10, y: 1, c: '#607890' },
      { x: 3, y: 2, c: '#607890' }, { x: 4, y: 2, c: '#789cb8' }, { x: 5, y: 2, c: '#90b8d0' }, { x: 6, y: 2, c: '#789cb8' }, { x: 7, y: 2, c: '#90b8d0' }, { x: 8, y: 2, c: '#789cb8' }, { x: 9, y: 2, c: '#90b8d0' }, { x: 10, y: 2, c: '#789cb8' }, { x: 11, y: 2, c: '#607890' },
      { x: 2, y: 3, c: '#506878' }, { x: 3, y: 3, c: '#607890' }, { x: 4, y: 3, c: '#607890' }, { x: 5, y: 3, c: '#607890' }, { x: 6, y: 3, c: '#607890' }, { x: 7, y: 3, c: '#607890' }, { x: 8, y: 3, c: '#607890' }, { x: 9, y: 3, c: '#607890' }, { x: 10, y: 3, c: '#607890' }, { x: 11, y: 3, c: '#607890' }, { x: 12, y: 3, c: '#506878' },
      { x: 4, y: 4, c: '#e8c8a0' }, { x: 5, y: 4, c: '#e8c8a0' }, { x: 6, y: 4, c: '#f0d8b8' }, { x: 7, y: 4, c: '#f0d8b8' }, { x: 8, y: 4, c: '#f0d8b8' }, { x: 9, y: 4, c: '#e8c8a0' }, { x: 10, y: 4, c: '#e8c8a0' },
      { x: 3, y: 5, c: '#e8c8a0' }, { x: 4, y: 5, c: '#f0d8b8' }, { x: 5, y: 5, c: '#382828' }, { x: 6, y: 5, c: '#f0d8b8' }, { x: 7, y: 5, c: '#f0d8b8' }, { x: 8, y: 5, c: '#f0d8b8' }, { x: 9, y: 5, c: '#382828' }, { x: 10, y: 5, c: '#f0d8b8' }, { x: 11, y: 5, c: '#e8c8a0' },
      { x: 3, y: 6, c: '#e8c8a0' }, { x: 4, y: 6, c: '#f0d8b8' }, { x: 5, y: 6, c: '#f0d8b8' }, { x: 6, y: 6, c: '#f0d8b8' }, { x: 7, y: 6, c: '#d8b090' }, { x: 8, y: 6, c: '#f0d8b8' }, { x: 9, y: 6, c: '#f0d8b8' }, { x: 10, y: 6, c: '#f0d8b8' }, { x: 11, y: 6, c: '#e8c8a0' },
      { x: 4, y: 7, c: '#e8c8a0' }, { x: 5, y: 7, c: '#f0d8b8' }, { x: 6, y: 7, c: '#c09880' }, { x: 7, y: 7, c: '#c09880' }, { x: 8, y: 7, c: '#c09880' }, { x: 9, y: 7, c: '#f0d8b8' }, { x: 10, y: 7, c: '#e8c8a0' },
      { x: 5, y: 8, c: '#e8c8a0' }, { x: 6, y: 8, c: '#e8c8a0' }, { x: 7, y: 8, c: '#e8c8a0' }, { x: 8, y: 8, c: '#e8c8a0' }, { x: 9, y: 8, c: '#e8c8a0' },
      { x: 6, y: 9, c: '#d8b890' }, { x: 7, y: 9, c: '#d8b890' }, { x: 8, y: 9, c: '#d8b890' },
      { x: 2, y: 10, c: '#607890' }, { x: 3, y: 10, c: '#789cb8' }, { x: 4, y: 10, c: '#789cb8' }, { x: 5, y: 10, c: '#607890' }, { x: 6, y: 10, c: '#607890' }, { x: 7, y: 10, c: '#607890' }, { x: 8, y: 10, c: '#607890' }, { x: 9, y: 10, c: '#607890' }, { x: 10, y: 10, c: '#789cb8' }, { x: 11, y: 10, c: '#789cb8' }, { x: 12, y: 10, c: '#607890' },
      { x: 1, y: 11, c: '#506878' }, { x: 2, y: 11, c: '#789cb8' }, { x: 3, y: 11, c: '#90b8d0' }, { x: 4, y: 11, c: '#789cb8' }, { x: 5, y: 11, c: '#607890' }, { x: 6, y: 11, c: '#789cb8' }, { x: 7, y: 11, c: '#90b8d0' }, { x: 8, y: 11, c: '#789cb8' }, { x: 9, y: 11, c: '#607890' }, { x: 10, y: 11, c: '#789cb8' }, { x: 11, y: 11, c: '#90b8d0' }, { x: 12, y: 11, c: '#789cb8' }, { x: 13, y: 11, c: '#506878' },
      { x: 1, y: 12, c: '#506878' }, { x: 2, y: 12, c: '#607890' }, { x: 3, y: 12, c: '#789cb8' }, { x: 4, y: 12, c: '#607890' }, { x: 5, y: 12, c: '#607890' }, { x: 6, y: 12, c: '#789cb8' }, { x: 7, y: 12, c: '#c0c0c0' }, { x: 8, y: 12, c: '#789cb8' }, { x: 9, y: 12, c: '#607890' }, { x: 10, y: 12, c: '#607890' }, { x: 11, y: 12, c: '#789cb8' }, { x: 12, y: 12, c: '#607890' }, { x: 13, y: 12, c: '#506878' },
      { x: 2, y: 13, c: '#607890' }, { x: 3, y: 13, c: '#607890' }, { x: 4, y: 13, c: '#607890' }, { x: 5, y: 13, c: '#607890' }, { x: 6, y: 13, c: '#607890' }, { x: 7, y: 13, c: '#607890' }, { x: 8, y: 13, c: '#607890' }, { x: 9, y: 13, c: '#607890' }, { x: 10, y: 13, c: '#607890' }, { x: 11, y: 13, c: '#607890' }, { x: 12, y: 13, c: '#607890' },
    ]
  },
  mage: {
    pixels: [
      { x: 7, y: 0, c: '#584078' },
      { x: 6, y: 1, c: '#584078' }, { x: 7, y: 1, c: '#7858a0' }, { x: 8, y: 1, c: '#584078' },
      { x: 5, y: 2, c: '#584078' }, { x: 6, y: 2, c: '#7858a0' }, { x: 7, y: 2, c: '#9070b8' }, { x: 8, y: 2, c: '#7858a0' }, { x: 9, y: 2, c: '#584078' },
      { x: 2, y: 3, c: '#483068' }, { x: 3, y: 3, c: '#584078' }, { x: 4, y: 3, c: '#584078' }, { x: 5, y: 3, c: '#7858a0' }, { x: 6, y: 3, c: '#7858a0' }, { x: 7, y: 3, c: '#f8e060' }, { x: 8, y: 3, c: '#7858a0' }, { x: 9, y: 3, c: '#7858a0' }, { x: 10, y: 3, c: '#584078' }, { x: 11, y: 3, c: '#584078' }, { x: 12, y: 3, c: '#483068' },
      { x: 3, y: 4, c: '#c0c0d0' }, { x: 4, y: 4, c: '#e8c8a0' }, { x: 5, y: 4, c: '#f0d8b8' }, { x: 6, y: 4, c: '#f0d8b8' }, { x: 7, y: 4, c: '#f0d8b8' }, { x: 8, y: 4, c: '#f0d8b8' }, { x: 9, y: 4, c: '#f0d8b8' }, { x: 10, y: 4, c: '#e8c8a0' }, { x: 11, y: 4, c: '#c0c0d0' },
      { x: 3, y: 5, c: '#c0c0d0' }, { x: 4, y: 5, c: '#f0d8b8' }, { x: 5, y: 5, c: '#382858' }, { x: 6, y: 5, c: '#f0d8b8' }, { x: 7, y: 5, c: '#f0d8b8' }, { x: 8, y: 5, c: '#f0d8b8' }, { x: 9, y: 5, c: '#382858' }, { x: 10, y: 5, c: '#f0d8b8' }, { x: 11, y: 5, c: '#c0c0d0' },
      { x: 3, y: 6, c: '#c0c0d0' }, { x: 4, y: 6, c: '#f0d8b8' }, { x: 5, y: 6, c: '#f0d8b8' }, { x: 6, y: 6, c: '#f0d8b8' }, { x: 7, y: 6, c: '#d8b090' }, { x: 8, y: 6, c: '#f0d8b8' }, { x: 9, y: 6, c: '#f0d8b8' }, { x: 10, y: 6, c: '#f0d8b8' }, { x: 11, y: 6, c: '#c0c0d0' },
      { x: 4, y: 7, c: '#e8c8a0' }, { x: 5, y: 7, c: '#f0d8b8' }, { x: 6, y: 7, c: '#b88880' }, { x: 7, y: 7, c: '#f0d8b8' }, { x: 8, y: 7, c: '#b88880' }, { x: 9, y: 7, c: '#f0d8b8' }, { x: 10, y: 7, c: '#e8c8a0' },
      { x: 5, y: 8, c: '#e8c8a0' }, { x: 6, y: 8, c: '#e8c8a0' }, { x: 7, y: 8, c: '#e8c8a0' }, { x: 8, y: 8, c: '#e8c8a0' }, { x: 9, y: 8, c: '#e8c8a0' },
      { x: 5, y: 9, c: '#c0c0d0' }, { x: 6, y: 9, c: '#d8b890' }, { x: 7, y: 9, c: '#d8b890' }, { x: 8, y: 9, c: '#d8b890' }, { x: 9, y: 9, c: '#c0c0d0' },
      { x: 3, y: 10, c: '#584078' }, { x: 4, y: 10, c: '#7858a0' }, { x: 5, y: 10, c: '#584078' }, { x: 6, y: 10, c: '#584078' }, { x: 7, y: 10, c: '#584078' }, { x: 8, y: 10, c: '#584078' }, { x: 9, y: 10, c: '#584078' }, { x: 10, y: 10, c: '#7858a0' }, { x: 11, y: 10, c: '#584078' },
      { x: 2, y: 11, c: '#483068' }, { x: 3, y: 11, c: '#7858a0' }, { x: 4, y: 11, c: '#9070b8' }, { x: 5, y: 11, c: '#7858a0' }, { x: 6, y: 11, c: '#584078' }, { x: 7, y: 11, c: '#f8e060' }, { x: 8, y: 11, c: '#584078' }, { x: 9, y: 11, c: '#7858a0' }, { x: 10, y: 11, c: '#9070b8' }, { x: 11, y: 11, c: '#7858a0' }, { x: 12, y: 11, c: '#483068' },
      { x: 2, y: 12, c: '#483068' }, { x: 3, y: 12, c: '#584078' }, { x: 4, y: 12, c: '#7858a0' }, { x: 5, y: 12, c: '#584078' }, { x: 6, y: 12, c: '#7858a0' }, { x: 7, y: 12, c: '#9070b8' }, { x: 8, y: 12, c: '#7858a0' }, { x: 9, y: 12, c: '#584078' }, { x: 10, y: 12, c: '#7858a0' }, { x: 11, y: 12, c: '#584078' }, { x: 12, y: 12, c: '#483068' },
      { x: 3, y: 13, c: '#584078' }, { x: 4, y: 13, c: '#584078' }, { x: 5, y: 13, c: '#584078' }, { x: 6, y: 13, c: '#584078' }, { x: 7, y: 13, c: '#584078' }, { x: 8, y: 13, c: '#584078' }, { x: 9, y: 13, c: '#584078' }, { x: 10, y: 13, c: '#584078' }, { x: 11, y: 13, c: '#584078' },
    ]
  },
  gatherer: {
    pixels: [
      { x: 5, y: 0, c: '#3a6838' }, { x: 6, y: 0, c: '#3a6838' }, { x: 7, y: 0, c: '#3a6838' }, { x: 8, y: 0, c: '#3a6838' }, { x: 9, y: 0, c: '#3a6838' },
      { x: 4, y: 1, c: '#3a6838' }, { x: 5, y: 1, c: '#508848' }, { x: 6, y: 1, c: '#508848' }, { x: 7, y: 1, c: '#60a058' }, { x: 8, y: 1, c: '#508848' }, { x: 9, y: 1, c: '#508848' }, { x: 10, y: 1, c: '#3a6838' },
      { x: 3, y: 2, c: '#3a6838' }, { x: 4, y: 2, c: '#508848' }, { x: 5, y: 2, c: '#60a058' }, { x: 6, y: 2, c: '#508848' }, { x: 7, y: 2, c: '#60a058' }, { x: 8, y: 2, c: '#508848' }, { x: 9, y: 2, c: '#60a058' }, { x: 10, y: 2, c: '#508848' }, { x: 11, y: 2, c: '#3a6838' },
      { x: 3, y: 3, c: '#2a5028' }, { x: 4, y: 3, c: '#3a6838' }, { x: 5, y: 3, c: '#3a6838' }, { x: 6, y: 3, c: '#3a6838' }, { x: 7, y: 3, c: '#3a6838' }, { x: 8, y: 3, c: '#3a6838' }, { x: 9, y: 3, c: '#3a6838' }, { x: 10, y: 3, c: '#3a6838' }, { x: 11, y: 3, c: '#2a5028' },
      { x: 3, y: 4, c: '#3a6838' }, { x: 4, y: 4, c: '#e0c098' }, { x: 5, y: 4, c: '#f0d8b8' }, { x: 6, y: 4, c: '#f0d8b8' }, { x: 7, y: 4, c: '#f0d8b8' }, { x: 8, y: 4, c: '#f0d8b8' }, { x: 9, y: 4, c: '#f0d8b8' }, { x: 10, y: 4, c: '#e0c098' }, { x: 11, y: 4, c: '#3a6838' },
      { x: 3, y: 5, c: '#3a6838' }, { x: 4, y: 5, c: '#f0d8b8' }, { x: 5, y: 5, c: '#283818' }, { x: 6, y: 5, c: '#f0d8b8' }, { x: 7, y: 5, c: '#f0d8b8' }, { x: 8, y: 5, c: '#f0d8b8' }, { x: 9, y: 5, c: '#283818' }, { x: 10, y: 5, c: '#f0d8b8' }, { x: 11, y: 5, c: '#3a6838' },
      { x: 4, y: 6, c: '#f0d8b8' }, { x: 5, y: 6, c: '#f0d8b8' }, { x: 6, y: 6, c: '#f0d8b8' }, { x: 7, y: 6, c: '#d8b090' }, { x: 8, y: 6, c: '#f0d8b8' }, { x: 9, y: 6, c: '#f0d8b8' }, { x: 10, y: 6, c: '#f0d8b8' },
      { x: 4, y: 7, c: '#e8c8a0' }, { x: 5, y: 7, c: '#f0d8b8' }, { x: 6, y: 7, c: '#c09880' }, { x: 7, y: 7, c: '#c09880' }, { x: 8, y: 7, c: '#c09880' }, { x: 9, y: 7, c: '#f0d8b8' }, { x: 10, y: 7, c: '#e8c8a0' },
      { x: 5, y: 8, c: '#e8c8a0' }, { x: 6, y: 8, c: '#e8c8a0' }, { x: 7, y: 8, c: '#e8c8a0' }, { x: 8, y: 8, c: '#e8c8a0' }, { x: 9, y: 8, c: '#e8c8a0' },
      { x: 5, y: 9, c: '#a07848' }, { x: 6, y: 9, c: '#d8b890' }, { x: 7, y: 9, c: '#d8b890' }, { x: 8, y: 9, c: '#d8b890' }, { x: 9, y: 9, c: '#a07848' },
      { x: 3, y: 10, c: '#3a6838' }, { x: 4, y: 10, c: '#508848' }, { x: 5, y: 10, c: '#3a6838' }, { x: 6, y: 10, c: '#3a6838' }, { x: 7, y: 10, c: '#3a6838' }, { x: 8, y: 10, c: '#3a6838' }, { x: 9, y: 10, c: '#3a6838' }, { x: 10, y: 10, c: '#508848' }, { x: 11, y: 10, c: '#3a6838' },
      { x: 2, y: 11, c: '#2a5028' }, { x: 3, y: 11, c: '#508848' }, { x: 4, y: 11, c: '#60a058' }, { x: 5, y: 11, c: '#508848' }, { x: 6, y: 11, c: '#3a6838' }, { x: 7, y: 11, c: '#a07848' }, { x: 8, y: 11, c: '#3a6838' }, { x: 9, y: 11, c: '#508848' }, { x: 10, y: 11, c: '#60a058' }, { x: 11, y: 11, c: '#508848' }, { x: 12, y: 11, c: '#2a5028' },
      { x: 2, y: 12, c: '#2a5028' }, { x: 3, y: 12, c: '#3a6838' }, { x: 4, y: 12, c: '#508848' }, { x: 5, y: 12, c: '#3a6838' }, { x: 6, y: 12, c: '#508848' }, { x: 7, y: 12, c: '#60a058' }, { x: 8, y: 12, c: '#508848' }, { x: 9, y: 12, c: '#3a6838' }, { x: 10, y: 12, c: '#508848' }, { x: 11, y: 12, c: '#3a6838' }, { x: 12, y: 12, c: '#2a5028' },
      { x: 3, y: 13, c: '#3a6838' }, { x: 4, y: 13, c: '#3a6838' }, { x: 5, y: 13, c: '#3a6838' }, { x: 6, y: 13, c: '#3a6838' }, { x: 7, y: 13, c: '#3a6838' }, { x: 8, y: 13, c: '#3a6838' }, { x: 9, y: 13, c: '#3a6838' }, { x: 10, y: 13, c: '#3a6838' }, { x: 11, y: 13, c: '#3a6838' },
    ]
  }
};

/* ==============================================================
   DRAW PORTRAIT ON CANVAS
   ============================================================== */
function drawPortrait(canvas, type) {
  const size = 14;
  canvas.width = size;
  canvas.height = size;
  const ctx = canvas.getContext('2d');
  ctx.fillStyle = '#f0e8e0';
  ctx.fillRect(0, 0, size, size);

  const data = PORTRAITS[type];
  if (!data) return;
  data.pixels.forEach(p => {
    ctx.fillStyle = p.c;
    ctx.fillRect(p.x, p.y, 1, 1);
  });
}

/* ==============================================================
   DRAW SHARED CHERRY BRANCH BANNER — one long branch
   ============================================================== */
function drawCherryBanner(canvas) {
  const w = 720;
  const h = 32;
  canvas.width = w;
  canvas.height = h;
  const ctx = canvas.getContext('2d');

  ctx.clearRect(0, 0, w, h);

  // Main branch — a long gentle curve spanning the full width
  const branchPoints = [
    [0, 20], [30, 18], [60, 15], [90, 13], [120, 12], [150, 13],
    [180, 15], [210, 14], [240, 11], [270, 9], [300, 10],
    [330, 12], [360, 14], [390, 12], [420, 10], [450, 9],
    [480, 11], [510, 13], [540, 12], [570, 10], [600, 11],
    [630, 13], [660, 15], [690, 17], [720, 19]
  ];

  // Draw main branch with 2px thickness
  ctx.fillStyle = '#684848';
  for (let i = 0; i < branchPoints.length - 1; i++) {
    const [x1, y1] = branchPoints[i];
    const [x2, y2] = branchPoints[i + 1];
    const steps = Math.max(Math.abs(x2 - x1), Math.abs(y2 - y1));
    for (let s = 0; s <= steps; s++) {
      const t = steps === 0 ? 0 : s / steps;
      const x = Math.round(x1 + (x2 - x1) * t);
      const y = Math.round(y1 + (y2 - y1) * t);
      ctx.fillRect(x, y, 2, 2);
    }
  }

  // Sub-branches drooping down and up
  const subBranches = [
    [[60, 15], [50, 8], [45, 4]],
    [[120, 12], [130, 6], [135, 3]],
    [[180, 15], [170, 8], [168, 5]],
    [[270, 9], [260, 4], [255, 2]],
    [[330, 12], [340, 6], [345, 3]],
    [[420, 10], [410, 5], [405, 2]],
    [[480, 11], [490, 5], [495, 2]],
    [[540, 12], [530, 6], [525, 3]],
    [[630, 13], [640, 7], [645, 4]],
    [[690, 17], [680, 10], [675, 7]],
    [[90, 13], [85, 8]],
    [[210, 14], [205, 9]],
    [[360, 14], [355, 9]],
    [[510, 13], [505, 8]],
    [[570, 10], [565, 5]],
    [[660, 15], [655, 10]],
  ];

  ctx.fillStyle = '#886060';
  subBranches.forEach(branch => {
    for (let i = 0; i < branch.length - 1; i++) {
      const [x1, y1] = branch[i];
      const [x2, y2] = branch[i + 1];
      const steps = Math.max(Math.abs(x2 - x1), Math.abs(y2 - y1));
      for (let s = 0; s <= steps; s++) {
        const t = steps === 0 ? 0 : s / steps;
        const x = Math.round(x1 + (x2 - x1) * t);
        const y = Math.round(y1 + (y2 - y1) * t);
        ctx.fillRect(x, y, 1, 1);
      }
    }
  });

  // Blossoms — clusters of pink pixels at sub-branch tips
  const blossomPositions = [
    [45, 3], [48, 5], [42, 6],
    [130, 3], [133, 5], [127, 4], [135, 2],
    [168, 4], [165, 6], [171, 5],
    [255, 1], [258, 3], [252, 3], [260, 2],
    [340, 3], [343, 5], [337, 4], [345, 2],
    [405, 1], [408, 3], [402, 3],
    [490, 2], [493, 4], [487, 3], [495, 1],
    [525, 2], [528, 4], [522, 3],
    [640, 3], [643, 5], [637, 4], [645, 3],
    [675, 6], [678, 8], [672, 7], [680, 6],
    [85, 7], [82, 9], [88, 8],
    [205, 8], [202, 10], [208, 9],
    [355, 8], [352, 10], [358, 9],
    [505, 7], [502, 9], [508, 8],
    [565, 4], [562, 6], [568, 5],
    [655, 9], [652, 11], [658, 10],
  ];

  const petalColors = ['#f0a0b8', '#f8c8d8', '#e88898', '#f0b0c0', '#f8d0d8'];
  blossomPositions.forEach(([bx, by]) => {
    const offsets = [[0, 0], [-1, 0], [1, 0], [0, -1], [0, 1]];
    offsets.forEach(([dx, dy], i) => {
      ctx.fillStyle = petalColors[i % petalColors.length];
      ctx.fillRect(bx + dx * 2, by + dy * 2, 2, 2);
    });
    ctx.fillStyle = '#f8e060';
    ctx.fillRect(bx, by, 1, 1);
  });
}

/* ==============================================================
   BUILD STRIP HTML
   ============================================================== */
function buildStrip(char, index) {
  const hpPct = (char.hp / char.maxHp * 100).toFixed(1);
  const xpPct = (char.xp / char.maxXp * 100).toFixed(1);
  const cdPct = (char.cooldown / char.maxCooldown * 100).toFixed(1);

  const strip = document.createElement('div');
  strip.className = 'strip';
  strip.innerHTML = `
    <div class="strip-right-blossoms"></div>

    <div class="strip-portrait">
      <div class="strip-portrait-border">
        <canvas class="portrait-canvas" data-type="${char.portraitType}"></canvas>
      </div>
    </div>

    <div class="strip-identity">
      <div class="strip-name">${char.name}</div>
      <span class="strip-level">LV ${char.level}</span>
    </div>

    <div class="strip-bars">
      <div class="strip-stat-row">
        <span class="strip-stat-label">HP</span>
        <div class="strip-bar-track">
          <div class="strip-bar-fill" style="width: ${hpPct}%"></div>
        </div>
        <span class="strip-stat-value">${char.hp}/${char.maxHp}</span>
      </div>
      <div class="strip-stat-row">
        <span class="strip-stat-label">XP</span>
        <div class="strip-bar-track xp-track">
          <div class="strip-bar-fill xp-fill" style="width: ${xpPct}%"></div>
        </div>
        <span class="strip-stat-value">${char.xp}/${char.maxXp}</span>
      </div>
    </div>

    <div class="strip-cooldown">
      <div class="strip-cd-bar-track">
        <div class="strip-cd-bar-fill" data-cd-bar="${index}" style="width: ${cdPct}%"></div>
      </div>
      <div class="strip-cd-text" data-cd-text="${index}">${char.cooldown.toFixed(1)}s</div>
    </div>

    <div class="strip-info">
      <div class="strip-info-line">
        <span class="strip-info-icon">></span>
        <span class="strip-info-text" data-log="${index}">${char.log}</span>
      </div>
      <div class="strip-info-line">
        <span class="strip-info-icon">*</span>
        <span class="strip-info-text">${char.task}</span>
      </div>
    </div>

    <div class="strip-buttons">
      <button class="strip-btn" title="Equipment">EQ</button>
      <button class="strip-btn" title="Inventory">IN</button>
      <button class="strip-btn" title="Skills">SK</button>
      <button class="strip-btn" title="Stats">ST</button>
      <button class="strip-btn" title="Achievements">AC</button>
    </div>
  `;
  return strip;
}

/* ==============================================================
   FLOATING PETALS
   ============================================================== */
function createPetals() {
  const container = document.getElementById('petalsContainer');
  const petalColors = ['#f0a0b8', '#f8c8d8', '#e88898', '#f0b0c0', '#f8d0d8', '#f8e0e8'];
  const count = 25;

  for (let i = 0; i < count; i++) {
    const petal = document.createElement('div');
    petal.className = 'petal';
    const size = Math.random() > 0.5 ? 4 : 3;
    petal.style.width = size + 'px';
    petal.style.height = size + 'px';
    petal.style.backgroundColor = petalColors[Math.floor(Math.random() * petalColors.length)];
    petal.style.left = Math.random() * 100 + '%';
    petal.style.top = -10 + 'px';
    petal.style.animationDuration = (8 + Math.random() * 12) + 's';
    petal.style.animationDelay = (Math.random() * 15) + 's';
    container.appendChild(petal);
  }
}

/* ==============================================================
   COOLDOWN TIMERS
   ============================================================== */
const cooldowns = characters.map(c => ({
  current: c.cooldown,
  max: c.maxCooldown,
  readyAt: 0,
  isReady: false
}));

function tickCooldowns() {
  const now = Date.now();
  cooldowns.forEach((cd, i) => {
    if (cd.isReady) {
      if (now - cd.readyAt >= 1500) {
        cd.current = cd.max;
        cd.isReady = false;
      }
    } else {
      cd.current -= 0.1;
      if (cd.current <= 0) {
        cd.current = 0;
        cd.isReady = true;
        cd.readyAt = now;
      }
    }

    const bar = document.querySelector(`[data-cd-bar="${i}"]`);
    const text = document.querySelector(`[data-cd-text="${i}"]`);
    if (!bar || !text) return;

    if (cd.isReady) {
      bar.style.width = '100%';
      bar.classList.add('ready');
      text.textContent = 'READY';
      text.classList.add('ready-flash');
    } else {
      const pct = (cd.current / cd.max * 100).toFixed(1);
      bar.style.width = pct + '%';
      bar.classList.remove('ready');
      text.textContent = cd.current.toFixed(1) + 's';
      text.classList.remove('ready-flash');
    }
  });
}

/* ==============================================================
   LOG ROTATION
   ============================================================== */
const logIndices = characters.map(() => 0);

function rotateLogs() {
  characters.forEach((char, i) => {
    logIndices[i] = (logIndices[i] + 1) % char.logs.length;
    const el = document.querySelector(`[data-log="${i}"]`);
    if (el) {
      el.textContent = char.logs[logIndices[i]];
    }
  });
}

/* ==============================================================
   INIT
   ============================================================== */
function init() {
  const container = document.getElementById('stripsContainer');

  // Draw shared cherry branch banner
  const bannerCanvas = document.getElementById('bannerCanvas');
  drawCherryBanner(bannerCanvas);

  // Build strips
  characters.forEach((char, i) => {
    container.appendChild(buildStrip(char, i));
  });

  // Draw portraits
  document.querySelectorAll('.portrait-canvas').forEach(canvas => {
    drawPortrait(canvas, canvas.dataset.type);
  });

  // Create floating petals
  createPetals();

  // Start cooldown ticker (100ms)
  setInterval(tickCooldowns, 100);

  // Start log rotation (3s)
  setInterval(rotateLogs, 3000);
}

document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
